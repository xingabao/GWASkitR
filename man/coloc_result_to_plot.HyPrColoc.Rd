% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/coloc_result_to_plot.R
\name{coloc_result_to_plot.HyPrColoc}
\alias{coloc_result_to_plot.HyPrColoc}
\title{Prepare HyPrColoc Colocalization Results for Visualization}
\usage{
\method{coloc_result_to_plot}{HyPrColoc}(x, plink = NULL, bfile = NULL, verbose = TRUE)
}
\arguments{
\item{x}{A list, output from \code{\link{COLOC.HyPrColoc}}, containing association data,
SNPs, betas, ses, and traits.}

\item{plink}{Character. Path to the PLINK executable, used for LD matrix computation.}

\item{bfile}{Character. Path prefix for PLINK binary reference files (e.g., 1000G EUR).}

\item{verbose}{Logical. If \code{TRUE}, log informational messages (default: \code{TRUE}).}
}
\value{
A list with elements:
  \describe{
    \item{\code{geni.dat}}{Merged association data, ready for visualization.}
    \item{\code{ld_matrix}}{SNP-by-SNP local LD matrix.}
    \item{\code{snps}}{Vector of included SNPs.}
    \item{\code{betas}}{Matrix of beta values for included SNPs.}
    \item{\code{ses}}{Matrix of standard errors for included SNPs.}
    \item{\code{traits}}{Vector of trait/dataset names.}
    \item{\code{pop}}{Population/biobank tag, extracted from \code{bfile} name.}
  }
}
\description{
Processes colocalization results from \code{\link{COLOC.HyPrColoc}} and computes
a local LD matrix for intersecting SNPs using PLINK, preparing the results for
downstream regional visualization or integration with plotting packages.
}
\details{
This function is typically used after running \code{\link{COLOC.HyPrColoc}} to
harmonize association and LD data for regional visualization (e.g., with \pkg{geni.plots}).
Both \code{plink} and \code{bfile} are required for local LD matrix calculation.
}
\section{Workflow Example}{

\enumerate{
  \item Run \code{COLOC.HyPrColoc} to obtain multi-trait colocalization results.
  \item Use this function to integrate LD matrix and regional association data for visualization.
  \item Visualize regions using \pkg{geni.plots} or \pkg{locuscomparer}.
  \item Optional: Perform sensitivity analysis and trait comparisons.
}
}

\examples{
\dontrun{
# Load required packages
library(GWASkitR)
library(locuscomparer)

# Assuming PWCoCo.res is the output from COLOC.HyPrColoc
# Prepare data for visualization
coloc.dat <- coloc_result_to_plot(
  x = HyPrColoc.res,
  plink = "your/path/to/plink/plink.exe",
  bfile = "your/path/to/plink/1kg.v3/EUR"
)

# Visualize with geni.plots (or other locus plotting tools)
geni.plots::fig_region_stack(
  data = coloc.dat[['geni.dat']],
  traits = coloc.dat[['traits']],
  corr = coloc.dat[['ld_matrix']],
  build = 37,
  title_center = TRUE
)

# Sensitivity analysis (optional)
hyprcoloc::sensitivity.plot(
  effect.est = coloc.dat[['betas']],
  effect.se = coloc.dat[['ses']],
  trait.names = coloc.dat[['traits']],
  snp.id = coloc.dat[['snps']]
)
}

}
\seealso{
\code{\link{COLOC.HyPrColoc}}
}
\author{
Abao Xing (\email{albertxn7@gmail.com})
}
