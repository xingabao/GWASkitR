% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/coloc_result_to_plot.R
\name{coloc_result_to_plot.PWCoCo}
\alias{coloc_result_to_plot.PWCoCo}
\title{Prepare PWCOCO Colocalization Results for Plotting}
\usage{
\method{coloc_result_to_plot}{PWCoCo}(x, rs, plink = NULL, bfile = NULL, verbose = TRUE)
}
\arguments{
\item{x}{List of class \code{pwcoco}. Output from \code{COLOC.PWCoCo}, containing colocalization and summary statistics data.}

\item{rs}{Character. Specific SNP ID (e.g., 'rs123') to focus on for plotting. Must follow the 'rs' + number format.}

\item{plink}{Character. Path to the PLINK executable for LD computation. Must be provided.}

\item{bfile}{Character. Path prefix for PLINK binary reference files (e.g., 1000G EUR). Must be provided.}

\item{verbose}{Logical. Whether to output verbose messages for debugging (default: TRUE).}
}
\value{
A list containing the following elements for plotting:
  \item{in_fn1}{Data frame for trait 1 with columns \code{rsid} (SNP ID) and \code{pval} (p-value).}
  \item{in_fn2}{Data frame for trait 2 with columns \code{rsid} (SNP ID) and \code{pval} (p-value).}
  \item{ld_matrix}{Matrix. SNP-by-SNP LD (linkage disequilibrium) matrix computed using PLINK.}
  \item{geni.dat}{Data frame. Merged association data for plotting with columns \code{marker}, \code{chr}, \code{pos}, \code{z_1}, and \code{z_2}.}
  \item{SNP}{Character. The specified SNP ID for focus.}
  \item{pop}{Character. The basename of the reference bfile used.}
}
\description{
Processes colocalization results from \code{COLOC.PWCoCo} for plotting, focusing on a specific SNP. This function
extracts relevant data for the specified SNP, computes an LD matrix, and prepares association data for visualization
using tools like \code{locuscomparer}.
}
\details{
This function processes the output of \code{COLOC.PWCoCo} to prepare data for colocalization plotting. It validates
the input SNP ID, loads summary statistics for the specified SNP, computes an LD matrix using PLINK, and merges
association data for the two traits. The resulting data structures are formatted for compatibility with plotting
tools such as \code{locuscomparer::locuscompare}. Ensure that PLINK and the reference files are accessible, and
the SNP ID exists in the colocalization results.
}
\examples{
\dontrun{
# Load required packages
library(GWASkitR)
library(locuscomparer)

# Assuming PWCoCo.res is the output from COLOC.PWCoCo
# Prepare data for visualization
coloc.dat <- coloc_result_to_plot_pwcoco(
  data = PWCoCo.res,
  rs = "rs1260326",
  plink = "your/path/to/plink/plink.exe",
  bfile = "your/path/to/plink/1kg.v3/EUR",
  verbose = TRUE
)

# Visualize results using locuscomparer
locuscomparer::locuscompare(
  in_fn1 = coloc.dat[["in_fn1"]],
  in_fn2 = coloc.dat[["in_fn2"]],
  title1 = "eQTL",
  title2 = "GWAS",
  genome = "hg19",
  snp = coloc.dat[["SNP"]],
  population = "EUR",
  combine = TRUE
)
}

}
\seealso{
\code{\link{COLOC.PWCoCo}}
}
\author{
Abao Xing
}
