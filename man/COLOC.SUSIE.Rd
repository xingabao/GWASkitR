% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/COLOC.SUSIE.R
\name{COLOC.SUSIE}
\alias{COLOC.SUSIE}
\title{Perform Colocalization Analysis using COLOC with SuSiE}
\usage{
COLOC.SUSIE(
  e.dat,
  o.dat,
  e.col.chr = "CHR",
  e.col.pos = "POS",
  e.col.snp = "SNP",
  e.col.beta = "beta",
  e.col.se = "se",
  e.col.eaf = "eaf",
  e.col.pval = "pval",
  e.col.ncase = NA,
  e.col.nsample = NA,
  e.col.maf = NA,
  e.type = "quant",
  o.col.snp = "SNP",
  o.col.beta = "beta",
  o.col.se = "se",
  o.col.eaf = "eaf",
  o.col.pval = "pval",
  o.col.ncase = NA,
  o.col.nsample = NA,
  o.col.maf = NA,
  o.type = "cc",
  o.prevalence = NA,
  p1 = 1e-04,
  p2 = 1e-04,
  p12 = 1e-05,
  threshold = 0.8,
  plink = NULL,
  bfile = NULL,
  verbose = TRUE
)
}
\arguments{
\item{e.dat}{Data frame or character string. Input dataset for exposure (e.g., eQTL data) or path to the data file.}

\item{o.dat}{Data frame or character string. Input dataset for outcome (e.g., GWAS data) or path to the data file.}

\item{e.col.chr}{Character. Column name for chromosome in exposure data. Default: \code{"CHR"}.}

\item{e.col.pos}{Character. Column name for position in exposure data. Default: \code{"POS"}.}

\item{e.col.snp}{Character. Column name for SNP ID in exposure data. Default: \code{"SNP"}.}

\item{e.col.beta}{Character. Column name for beta effect in exposure data. Default: \code{"beta"}.}

\item{e.col.se}{Character. Column name for standard error in exposure data. Default: \code{"se"}.}

\item{e.col.eaf}{Character. Column name for effect allele frequency in exposure data. Default: \code{"eaf"}.}

\item{e.col.pval}{Character. Column name for p-value in exposure data. Default: \code{"pval"}.}

\item{e.col.ncase}{Character or numeric. Column name or value for number of cases in exposure data. Default: \code{NA}.}

\item{e.col.nsample}{Character or numeric. Column name or value for sample size in exposure data. Default: \code{NA}.}

\item{e.col.maf}{Character. Column name for minor allele frequency in exposure data. Default: \code{NA}.}

\item{e.type}{Character. Type of exposure data, either \code{"quant"} for quantitative or \code{"cc"} for case-control. Default: \code{"quant"}.}

\item{o.col.snp}{Character. Column name for SNP ID in outcome data. Default: \code{"SNP"}.}

\item{o.col.beta}{Character. Column name for beta effect in outcome data. Default: \code{"beta"}.}

\item{o.col.se}{Character. Column name for standard error in outcome data. Default: \code{"se"}.}

\item{o.col.eaf}{Character. Column name for effect allele frequency in outcome data. Default: \code{"eaf"}.}

\item{o.col.pval}{Character. Column name for p-value in outcome data. Default: \code{"pval"}.}

\item{o.col.ncase}{Character or numeric. Column name or value for number of cases in outcome data. Default: \code{NA}.}

\item{o.col.nsample}{Character or numeric. Column name or value for sample size in outcome data. Default: \code{NA}.}

\item{o.col.maf}{Character. Column name for minor allele frequency in outcome data. Default: \code{NA}.}

\item{o.type}{Character. Type of outcome data, either \code{"quant"} for quantitative or \code{"cc"} for case-control. Default: \code{"cc"}.}

\item{o.prevalence}{Numeric. Prevalence of outcome for case-control data. Default: \code{NA}.}

\item{p1}{Numeric. Prior probability for association in exposure dataset. Default: \code{1e-04}.}

\item{p2}{Numeric. Prior probability for association in outcome dataset. Default: \code{1e-04}.}

\item{p12}{Numeric. Prior probability for colocalization. Default: \code{1e-05}.}

\item{threshold}{Numeric. Posterior probability threshold for significant colocalization. Default: \code{0.8}.}

\item{plink}{Character. Path to PLINK executable for LD computation. Default: \code{NULL}.}

\item{bfile}{Character. Path to PLINK binary file for LD reference. Default: \code{NULL}.}

\item{verbose}{Logical. If \code{TRUE}, log detailed information about the analysis process. Default: \code{TRUE}.}
}
\value{
A list containing the following elements:
  \describe{
    \item{\code{coloc.dat}}{Full colocalization results from \code{coloc.susie}.}
    \item{\code{dataset1}}{List of processed exposure data for colocalization.}
    \item{\code{dataset2}}{List of processed outcome data for colocalization.}
    \item{\code{summary}}{Summary of colocalization results.}
    \item{\code{results}}{Data frame of detailed colocalization results sorted by posterior probability.}
    \item{\code{priors}}{Prior probabilities used in the analysis.}
    \item{\code{assoc}}{Data frame with marker information and Z-scores for both datasets.}
    \item{\code{snp.sig}}{Vector of significant SNPs based on the colocalization threshold.}
    \item{\code{in_fn1}}{Subset of exposure data with rsID and p-values.}
    \item{\code{in_fn2}}{Subset of outcome data with rsID and p-values.}
    \item{\code{ld_matrix}}{Matrix of LD correlations between SNPs.}
  }
}
\description{
This function performs colocalization analysis between two datasets (e.g., eQTL and GWAS data)
using the \code{coloc} package with SuSiE (Sum of Single Effects) for fine-mapping.
It processes input datasets, computes linkage disequilibrium (LD) matrices, and evaluates
colocalization evidence based on specified prior probabilities and thresholds.
}
\details{
This function integrates the \code{coloc} package's SuSiE framework to perform fine-mapping and colocalization
analysis between two traits, such as eQTL and GWAS data. It requires LD information, which is computed using
PLINK if provided. The function handles data preprocessing, including filtering for common SNPs and preparing
input for the \code{coloc.susie} function. Results are returned in a comprehensive list format for downstream
visualization and interpretation.
}
\examples{
\dontrun{
# Step 0. Load packages.
library(GWASkitR)
library(locuscomparer)

# Step 1: Perform analysis
SUSIE.res <- COLOC.SUSIE(
  e.dat = GWASkitR::pQTLdat,
  o.dat = GWASkitR::sumstats,
  e.col.chr = "CHR",
  e.col.pos = "POS",
  e.col.snp = "SNP",
  e.col.beta = "beta",
  e.col.se = "se",
  e.col.eaf = "eaf",
  e.col.pval = "pval",
  e.col.nsample = 35373,
  e.col.maf = "MAF",
  e.type = "quant",
  o.col.snp = "SNP",
  o.col.beta = "beta",
  o.col.se = "se",
  o.col.eaf = "eaf",
  o.col.pval = "pval",
  o.col.ncase = 33043,
  o.col.nsample = 318014,
  o.col.maf = "MAF",
  o.type = "cc",
  plink = "/your/path/to/plink/plink.exe",
  bfile = "/your/path/to/plink/1kg.v3/EUR"
)

# Step 2: Data preparation for visualization
coloc.dat <- coloc_result_to_plot(
  x = SUSIE.res,
  rs = "rs1260326"
)

# Step 3: Visualization with locuscompare
title1 <- "eQTL"
title2 <- "GWAS"
locuscomparer::locuscompare(
  in_fn1 = coloc.dat[["in_fn1"]],
  in_fn2 = coloc.dat[["in_fn2"]],
  title1 = title1,
  title2 = title2,
  genome = "hg19",
  snp = coloc.dat[["SNP"]],
  population = coloc.dat[["pop"]],
  combine = TRUE
)

# Step 4: Sensitivity plot
coloc::sensitivity(
  obj = SUSIE.res[["coloc.dat"]],
  rule = "H4 > 0.8",
  row = 1,
  dataset1 = SUSIE.res[["dataset1"]],
  dataset2 = SUSIE.res[["dataset2"]],
  plot.manhattans = TRUE
)
}

}
\references{
[1] Liu, B., Gloudemans, M.J., Rao, A.S. et al. Abundant associations with gene
expression complicate GWAS follow-up. Nat Genet 51, 768â€“769 (2019).
 https://doi.org/10.1038/s41588-019-0404-0
}
\author{
[Abao Xing]
}
