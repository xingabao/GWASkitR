% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/COLOC.PWCoCo.R
\name{COLOC.PWCoCo}
\alias{COLOC.PWCoCo}
\title{Perform Pairwise Conditional and Colocalization Analysis using PWCOCO}
\usage{
COLOC.PWCoCo(
  sum_stats1,
  sum_stats2,
  n1,
  n2,
  p_cutoff1 = 5e-08,
  p_cutoff2 = 5e-08,
  top_snp = 1e+10,
  ld_window = 1e+07,
  collinear = 0.9,
  maf = 0.1,
  freq_threshold = 0.2,
  init_h4 = 80,
  coloc_pp = c(1e-04, 1e-04, 1e-05),
  n1_case = NULL,
  n2_case = NULL,
  chr = NULL,
  out_cond = TRUE,
  pve1 = NULL,
  pve2 = NULL,
  pve_file1 = NULL,
  pve_file2 = NULL,
  threads = 4,
  snp.index = 1,
  bfile = NULL,
  pwcoco = NULL,
  save_path = NULL,
  prefix = NULL,
  verbose = TRUE
)
}
\arguments{
\item{sum_stats1}{Character. Path to the first summary statistics file.}

\item{sum_stats2}{Character. Path to the second summary statistics file.}

\item{n1}{Numeric. Sample size for the first dataset. Must be a positive integer.}

\item{n2}{Numeric. Sample size for the second dataset. Must be a positive integer.}

\item{p_cutoff1}{Numeric. P-value threshold for the first dataset (default: 5e-08).}

\item{p_cutoff2}{Numeric. P-value threshold for the second dataset (default: 5e-08).}

\item{top_snp}{Numeric. Maximum number of top SNPs to consider (default: 1e+10).}

\item{ld_window}{Numeric. LD window size in base pairs for analysis (default: 1e+07).}

\item{collinear}{Numeric. Collinearity threshold for LD pruning (default: 0.9).}

\item{maf}{Numeric. Minor allele frequency threshold (default: 0.1).}

\item{freq_threshold}{Numeric. Frequency threshold for allele matching (default: 0.2).}

\item{init_h4}{Numeric. Initial value for H4 hypothesis in colocalization (default: 80).}

\item{coloc_pp}{Numeric vector. Posterior probability thresholds for colocalization (default: c(1e-04, 1e-04, 1e-05)).}

\item{n1_case}{Numeric. Number of cases for the first dataset if binary trait (default: NULL).}

\item{n2_case}{Numeric. Number of cases for the second dataset if binary trait (default: NULL).}

\item{chr}{Character or numeric. Chromosome to analyze (default: NULL, analyzes all chromosomes).}

\item{out_cond}{Logical. Whether to output conditional analysis results (default: TRUE).}

\item{pve1}{Numeric. Proportion of variance explained for the first dataset (default: NULL).}

\item{pve2}{Numeric. Proportion of variance explained for the second dataset (default: NULL).}

\item{pve_file1}{Character. Path to file with PVE for the first dataset (default: NULL).}

\item{pve_file2}{Character. Path to file with PVE for the second dataset (default: NULL).}

\item{threads}{Numeric. Number of threads to use for PWCOCO (default: 4).}

\item{snp.index}{Numeric. Index of SNP column in input files (default: 1).}

\item{bfile}{Character. Path to PLINK binary file for LD reference (default: NULL).}

\item{pwcoco}{Character. Path to the PWCOCO executable. Must be provided.}

\item{save_path}{Character. Directory path to save output files. Must be provided.}

\item{prefix}{Character. Prefix for output file names. Must be provided.}

\item{verbose}{Logical. Whether to output verbose messages for debugging (default: TRUE).}
}
\value{
A list of class \code{pwcoco} containing the following elements:
  \item{coloc.dat}{A data frame with colocalization results from PWCOCO.}
  \item{sum_stats1}{A named list of paths to conditional analysis output files for the first dataset, indexed by rsID.}
  \item{sum_stats2}{A named list of paths to conditional analysis output files for the second dataset, indexed by rsID.}
  \item{pop}{Character. The basename of the reference bfile used.}
}
\description{
This function performs pairwise conditional and colocalization analysis between two sets of summary statistics
using the PWCOCO tool. It prepares input arguments, runs the external PWCOCO command, and processes the output
to return colocalization results and associated files.
}
\details{
This function interfaces with the PWCOCO tool to perform pairwise conditional and colocalization analysis.
It validates input parameters, constructs the command-line arguments, executes the PWCOCO tool, and processes
the output files. Ensure that the PWCOCO executable and necessary input files are accessible, and the output
directory has write permissions. The function logs progress and errors if \code{verbose = TRUE}.
}
\examples{
\dontrun{
# Load required packages
library(GWASkitR)
library(locuscomparer)

# Perform colocalization analysis
PWCoCo.res <- GWASkitR::COLOC.PWCoCo(
  sum_stats1 = glue::glue("{datadir}/cis-p-QTL.txt"),
  sum_stats2 = glue::glue("{datadir}/sumstats-coloc.txt"),
  p_cutoff1 = 5e-08,
  p_cutoff2 = 5e-08,
  top_snp = 1e+10,
  ld_window = 1e+07,
  collinear = 0.9,
  maf = 0.1,
  freq_threshold = 0.2,
  init_h4 = 100,
  coloc_pp = c(1e-04, 1e-04, 1e-05),
  n1 = 35373,
  n2 = 318014,
  n1_case = NULL,
  n2_case = 33043,
  chr = 2,
  out_cond = TRUE,
  pve1 = NULL,
  pve2 = NULL,
  pve_file1 = NULL,
  pve_file2 = NULL,
  threads = 24,
  snp.index = 1,
  bfile = "your/path/to/plink/1kg.v3/EUR",
  pwcoco = "your/path/to/PWCoCo",
  save_path = "your/path/to/output/pwcoco",
  prefix = "pwcoco_result",
  verbose = TRUE
)

# Prepare data for visualization
coloc.dat <- coloc_result_to_plot_pwcoco(
  x = PWCoCo.res,
  rs = "rs1260326",
  plink = "your/path/to/plink/plink.exe",
  bfile = "your/path/to/plink/1kg.v3/EUR"
)

# Visualize results using locuscomparer
locuscomparer::locuscompare(
  in_fn1 = coloc.dat[["in_fn1"]],
  in_fn2 = coloc.dat[["in_fn2"]],
  title1 = "eQTL",
  title2 = "GWAS",
  genome = "hg19",
  snp = coloc.dat[["SNP"]],
  population = "EUR",
  combine = TRUE
)
}

}
