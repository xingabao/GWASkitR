% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/read.vcf.R
\name{read.vcf}
\alias{read.vcf}
\title{Read and Parse a VCF File for GWAS Summary Data}
\usage{
read.vcf(
  vcfFile,
  multiple = FALSE,
  remove_qual_filter_info = TRUE,
  save.path = NULL,
  nrows = NULL,
  verbose = TRUE
)
}
\arguments{
\item{vcfFile}{Character string. The path to the input VCF file. The file must
exist and be readable.}

\item{multiple}{Logical. If \code{TRUE}, parses data for all samples in the VCF
file. If \code{FALSE}, only the first sample is processed. Default is \code{FALSE}.}

\item{remove_qual_filter_info}{Logical. If \code{TRUE}, removes the \code{QUAL},
\code{FILTER}, and \code{INFO} columns from the output. Default is \code{TRUE}.}

\item{save.path}{Character string or \code{NULL}. Directory path to save parsed
data for each sample as a tab-separated text file. If \code{NULL}, no files are
saved. Default is \code{NULL}.}

\item{nrows}{Numeric or \code{NULL}. The maximum number of rows to read from the VCF file.}

\item{verbose}{Logical. If \code{TRUE}, prints progress and debugging messages
using the \code{logger} package. Default is \code{FALSE}.}
}
\value{
If \code{multiple = FALSE}, returns a \code{data.frame} containing parsed
  data for the first sample. If \code{multiple = TRUE}, returns a named list of
  \code{data.frame} objects, with each element corresponding to a sample in the
  VCF file.
}
\description{
This function reads a Variant Call Format (VCF) file containing GWAS summary
statistics, extracts relevant data, processes FORMAT fields, and optionally
saves the parsed data for each sample. Special handling is provided for
log-transformed p-values (LP, interpreted as -log10 p-value).
}
\details{
This function processes VCF files to extract GWAS summary statistics. It handles
the \code{FORMAT} field to split subfields into separate columns and converts
log-transformed p-values (LP) to standard p-values if detected. The function
supports both single-sample and multi-sample VCF files, with optional output
saving for each sample's data.
}
\examples{
\dontrun{
library(GWASkitR)

# Path to example VCF file
vcf.file <- system.file("extdata", "ieu-a-2.vcf.gz", package = "GWASkitR")

# Read and parse data for a single sample
sumstats.dt <- read.vcf(vcfFile = vcf.file, verbose = TRUE)

# Display the first few rows
head(sumstats.dt)
}

}
