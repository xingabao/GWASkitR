% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/COLOC.HyPrColoc.R
\name{COLOC.HyPrColoc}
\alias{COLOC.HyPrColoc}
\title{Multi-trait Colocalization Analysis via HyPrColoc}
\usage{
COLOC.HyPrColoc(
  sumstats,
  reg.thresh = 0.7,
  align.thresh = 0.7,
  prior.c = 0.02,
  verbose = TRUE
)
}
\arguments{
\item{sumstats}{A named list of data frames, each containing summary statistics
for one dataset. Each data frame must include columns: \code{"SNP"}, \code{"CHR"},
\code{"POS"}, \code{"beta"}, and \code{"se"}.}

\item{reg.thresh}{Numeric. The regional colocalization posterior probability threshold
(default: \code{0.7}).}

\item{align.thresh}{Numeric. The alignment threshold for colocalization (default: \code{0.7}).}

\item{prior.c}{Numeric. The prior probability of colocalization (default: \code{0.02}).}

\item{verbose}{Logical. If \code{TRUE}, log progress messages (default: \code{TRUE}).}
}
\value{
A named list with elements:
  \describe{
    \item{\code{coloc.dat}}{Results from \code{\link[hyprcoloc]{hyprcoloc}} analysis.}
    \item{\code{assoc}}{Data frame: SNP info and Z-scores for each dataset.}
    \item{\code{betas}}{Beta matrix (SNPs x datasets).}
    \item{\code{ses}}{Standard error matrix (SNPs x datasets).}
    \item{\code{traits}}{Traits/dataset names.}
    \item{\code{snps}}{Common SNPs analyzed.}
    \item{\code{snp.sig}}{Colocalization-candidate SNP(s).}
  }
}
\description{
Conducts colocalization analysis across multiple GWAS/QTL datasets using the
\pkg{hyprcoloc} package. The function harmonizes SNPs, constructs beta and
standard error matrices, and runs colocalization with customizable thresholds.
It is suitable for regional multi-trait colocalization (e.g., GWAS vs QTL).
}
\details{
All datasets must contain the required columns and the same set of SNPs in the region.
Non-overlapping SNPs are excluded. Internally, the function logs key steps and
checks input validity.
}
\section{Typical Workflow}{

\enumerate{
  \item Perform colocalization analysis with this function.
  \item Prepare data for visualization (e.g., using \code{coloc_result_to_plot()}).
  \item Visualize regional colocalization (e.g., \code{geni.plots::fig_region_stack()}).
  \item Optionally, run sensitivity analysis (\code{hyprcoloc::sensitivity.plot()}).
}
}

\examples{
\dontrun{
# Step 0. Load required packages
library(GWASkitR)
library(locuscomparer)

# Step 1. Perform colocalization analysis
HyPrColoc.res <- GWASkitR::COLOC.HyPrColoc(
  sumstats = list(
    pQTLdat = GWASkitR::pQTLdat,
    pQTLdat2 = GWASkitR::pQTLdat,
    GWASdat = GWASkitR::sumstats,
    GWASdat2 = GWASkitR::sumstats
  ),
  reg.thresh = 0.7,
  align.thresh = 0.7,
  prior.c = 0.02
)

# Step 2. Data preparation for visualization
coloc.dat <- coloc_result_to_plot(
  x = HyPrColoc.res,
  plink = "your/path/to/plink/plink.exe",
  bfile = "your/path/to/plink/1kg.v3/EUR"
)

# Step 3. Visualize the colocalization analysis results
geni.plots::fig_region_stack(
  data = coloc.dat[['geni.dat']],
  traits = coloc.dat[['traits']],
  corr = coloc.dat[['ld_matrix']],
  build = 37,
  title_center = TRUE
)

# Step 4. Sensitivity plot
hyprcoloc::sensitivity.plot(
  effect.est = coloc.dat[['betas']],
  effect.se = coloc.dat[['ses']],
  trait.names = coloc.dat[['traits']],
  snp.id = coloc.dat[['snps']],
  reg.thresh = 0.7,
  align.thresh = 0.7,
  prior.c = 0.02
)
}

}
\author{
Abao Xing (\email{albertxn7@gmail.com})
}
